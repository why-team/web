<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>论文搜索结果</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@500;600&family=Roboto&display=swap" rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link rel="stylesheet" href="css/all.css"/>
    <link href="css/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="lib/lightbox/css/lightbox.min.css" rel="stylesheet">


    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="css/style.css" rel="stylesheet">
<!--    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css">-->
    <link rel="stylesheet" href="css/animate.css">

    <script src="js/echarts.js"></script>

    <style>
        .highlighted-text
        { color: orange}

    </style>
</head>
<body class="body">
<div class="container-fluid bg-primary px-5 d-none d-lg-block">
    <div class="row gx-0">
        <div class="col-lg-8 text-center text-lg-start mb-2 mb-lg-0">
            <div class="d-inline-flex align-items-center" style="height: 45px;">
                <a class="btn btn-sm btn-outline-light btn-sm-square rounded-circle me-2" href=""><i class="fab fa-twitter fw-normal"></i></a>
                <a class="btn btn-sm btn-outline-light btn-sm-square rounded-circle me-2" href=""><i class="fab fa-facebook-f fw-normal"></i></a>
                <a class="btn btn-sm btn-outline-light btn-sm-square rounded-circle me-2" href=""><i class="fab fa-linkedin-in fw-normal"></i></a>
                <a class="btn btn-sm btn-outline-light btn-sm-square rounded-circle me-2" href=""><i class="fab fa-instagram fw-normal"></i></a>
                <a class="btn btn-sm btn-outline-light btn-sm-square rounded-circle" href=""><i class="fab fa-youtube fw-normal"></i></a>
            </div>
        </div>
        <div class="col-lg-4 text-center text-lg-end">
            <div class="d-inline-flex align-items-center" style="height: 45px;">
                <a href="login_example.html"><small class="me-3 text-light"><i class="fa fa-user me-2"></i>Register</small></a>
                <a href="login_example.html"><small class="me-3 text-light"><i class="fa fa-sign-in-alt me-2"></i>Login</small></a>
                <div class="dropdown">
                    <a href="#" class="dropdown-toggle text-light" data-bs-toggle="dropdown"><small><i class="fa fa-home me-2"></i> My Dashboard</small></a>
                    <div class="dropdown-menu rounded">
                        <a href="#" class="dropdown-item"><i class="fas fa-user-alt me-2"></i> My Profile</a>
                        <a href="#" class="dropdown-item"><i class="fas fa-comment-alt me-2"></i> Inbox</a>
                        <a href="#" class="dropdown-item"><i class="fas fa-bell me-2"></i> Notifications</a>
                        <a href="#" class="dropdown-item"><i class="fas fa-cog me-2"></i> Account Settings</a>
                        <a href="#" class="dropdown-item"><i class="fas fa-power-off me-2"></i> Log Out</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid position-relative p-0">
    <nav class="navbar navbar-expand-lg navbar-light px-4 px-lg-5 py-3 py-lg-0">
        <a href="index.html" class="navbar-brand p-0">
            <h1 class="m-0"><i class="fa fa-map-marker-alt me-3"></i>WHY</h1>
            <!-- <img src="img/logo.png" alt="Logo"> -->
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
            <span class="fa fa-bars"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
            <div class="navbar-nav ms-auto py-0">
                <a href="index.html" class="nav-item nav-link active">Home</a>
                <a href="about.html" class="nav-item nav-link">About</a>
                <a href="classify.html" class="nav-item nav-link">Classify</a>

                <a href="contact.html" class="nav-item nav-link">Contact</a>
            </div>
            <!--                    <a href="" class="btn btn-primary rounded-pill py-2 px-4 ms-lg-4">Book Now</a>-->
        </div>
    </nav>

    <!-- Carousel Start -->
    <div class="carousel-header">
        <div id="carouselId" class="carousel slide" data-bs-ride="carousel">
            <ol class="carousel-indicators">
                <li data-bs-target="#carouselId" data-bs-slide-to="0" class="active"></li>
                <li data-bs-target="#carouselId" data-bs-slide-to="1"></li>
                <li data-bs-target="#carouselId" data-bs-slide-to="2"></li>
            </ol>
            <div class="carousel-inner" role="listbox">
                <div class="carousel-item active">
                    <img src="img/sdu_logo2.jpg" class="img-fluid" alt="Image">
                    <div class="carousel-caption">
                        <div class="p-3 Middle_of_the_html paper_right" style="max-width: 900px;">
                            <h1 class="display-2 text-capitalize text-white mb-4 animate__animated animate__bounceIn"> Search </h1>
                            <p class="display-7 text-capitalize text-white mb-4 animate__animated animate__bounceIn animate__delay-1s" id="paper_results"></p>
                            <p class="display-8 text-capitalize text-white mb-4 animate__animated animate__bounceIn animate__delay-2s"> The relevant papers are as follows:</p>
                        </div>
                        <div class="line_feed Middle_of_the_html paper_left">
                            <input class="query input_box  border-0 rounded-pill w-100 py-3 ps-4 pe-6 " type="text" placeholder="Search the paper again" id="query">
                            <button onclick="sendData()" id="search_button" class="btn btn-primary rounded-pill py-2 px-4 position-absolute me-2">Send Data</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Carousel End -->
</div>

<!--<input class="query" type="text" placeholder="Eg: Thailand" id="query">-->
<script>
    const urlParams = new URLSearchParams(window.location.search);
    const paper_results = document.getElementById("paper_results")
    let query = urlParams.get('query');
    // console.log("Log:", query);
    query = query.trimStart();
    paper_results.innerHTML = "\"" + query + "\""
    // console.log("Log:", query);
    if(query === "")
    {

    }else{
        const token = localStorage.getItem("token")
        console.log(token)
        if (token === null){
            window.location.href = "login_example.html";
        }
        let dataToSend = new FormData();
        dataToSend.append("token", token)
        dataToSend.append("query", query)


        // 发送 POST 请求到后端
        fetch('http://49.232.169.105:8090/api/search', {
            method: 'POST',
            body: dataToSend
        })
            .then(response => response.json())
            .then(data => {
                // 处理后端返回的数据
                const total_number = data.count;
                const datalist = data.articles;
                const token = data.token;
                const nodedata = data.graphs;
                console.log(data)

                localStorage.setItem("token", token)
                createHtmlElement(total_number, datalist);
                createScatterPlot(nodedata,datalist);
                // createPagination(3);

            })
            .catch(error => {
                console.error('Error:', error);
            });
    }
</script>


<div id="results">
    <div class="mx-auto text-center mb-5" style="max-width: 900px;">
        <h5 class="section-title px-3 num_papers animate__animated animate__bounceIn animate__delay-3s">Total number of papers</h5>
        <h1 id="search_num" class="mb-0 animate__animated animate__bounceIn animate__delay-3s"></h1>
    </div>

    <div class="mx-auto text-center mb-5" style="max-width: 900px;">
        <h5 class="section-title px-3 num_papers animate__animated animate__bounceIn animate__delay-3s">correlation diagram</h5>
        <div id="echarts" class="animate__animated animate__bounceIn animate__delay-3s scatterPlot2" style="width: 1200px;height:800px;"></div>
    </div>

    <div class="mx-auto text-center mb-5" style="max-width: 900px;">
        <h5 class="section-title px-3 num_papers animate__animated animate__bounceIn animate__delay-3s">Paper specific information</h5>
    </div>
    <div class="papers_information" >
        <div class="column_left">
            <label class="label_left_input">
                <input class="left_input" placeholder="search within topic...">
                <button class="left_input_button"><i class="fa fa-search"></i></button>
            </label>
            <p class="num_years animate__animated animate__bounceIn animate__delay-4s">All years</p>
            <p id="specific_years" class="specific_years animate__animated animate__bounceIn animate__delay-4s"></p>
            <p class="map animate__animated animate__bounceIn animate__delay-4s">Word frequency statistics</p>
            <ul id="specific_words" class="specific_words animate__animated animate__bounceIn animate__delay-4s"></ul>
        </div>
        <div id="display" class="column_middle">

        </div>
        <div class="column_right">

        </div>
    </div>

    <div class="pagination" id="pagination">
    </div>
</div>
<script src="js/search_result_2.js"></script>
<script src="js/ChangeColor.js"></script>
</body>
</html>
